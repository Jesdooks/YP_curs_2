from datetime import datetime
import os

# Данные для отчетов предприятий
REPORTS_DATA = {
    "Агрохолдинг 'Зерно'": {
        "inn": "7700000001",
        "kpp": "7700000011",
        "ogrn": "1234567890124",
        "revenue": 1000000.00,
        "material_costs": 600000.00,
        "labor_costs": 200000.00,
        "operational_costs": 100000.00,
        "gross_profit": 300000.00,
        "vat_base": 1000000.00,
        "vat_rate": 20.0,
        "vat_amount": 200000.00,
        "profit_tax_base": 300000.00,
        "profit_tax_rate": 20.0,
        "profit_tax_amount": 60000.00,
        "insurance_base": 200000.00,
        "pension_rate": 22.0,
        "pension_amount": 44000.00,
        "medical_rate": 5.1,
        "medical_amount": 10200.00,
        "social_rate": 2.9,
        "social_amount": 5800.00,
        "total_insurance": 60000.00,
        "property_base": 5000000.00,
        "property_rate": 2.0,
        "property_amount": 100000.00,
        "total_tax": 460000.00,
        "trade_points_count": 5,
        "orders_count": 50,
        "employees_count": 20
    },
    "ЗАО 'СахарИндустрия'": {
        "inn": "7700000002",
        "kpp": "7700000012",
        "ogrn": "1234567890125",
        "revenue": 800000.00,
        "material_costs": 500000.00,
        "labor_costs": 150000.00,
        "operational_costs": 80000.00,
        "gross_profit": 70000.00,
        "vat_base": 800000.00,
        "vat_rate": 20.0,
        "vat_amount": 160000.00,
        "profit_tax_base": 70000.00,
        "profit_tax_rate": 20.0,
        "profit_tax_amount": 14000.00,
        "insurance_base": 150000.00,
        "pension_rate": 22.0,
        "pension_amount": 33000.00,
        "medical_rate": 5.1,
        "medical_amount": 7650.00,
        "social_rate": 2.9,
        "social_amount": 4350.00,
        "total_insurance": 45000.00,
        "property_base": 5000000.00,
        "property_rate": 2.0,
        "property_amount": 100000.00,
        "total_tax": 419000.00,
        "trade_points_count": 3,
        "orders_count": 30,
        "employees_count": 15
    },
    "ЗАО 'ЯйцоПтица'": {
        "inn": "7700000003",
        "kpp": "7700000013",
        "ogrn": "1234567890126",
        "revenue": 1200000.00,
        "material_costs": 700000.00,
        "labor_costs": 250000.00,
        "operational_costs": 120000.00,
        "gross_profit": 130000.00,
        "vat_base": 1200000.00,
        "vat_rate": 20.0,
        "vat_amount": 240000.00,
        "profit_tax_base": 130000.00,
        "profit_tax_rate": 20.0,
        "profit_tax_amount": 26000.00,
        "insurance_base": 250000.00,
        "pension_rate": 22.0,
        "pension_amount": 55000.00,
        "medical_rate": 5.1,
        "medical_amount": 12750.00,
        "social_rate": 2.9,
        "social_amount": 7250.00,
        "total_insurance": 75000.00,
        "property_base": 5000000.00,
        "property_rate": 2.0,
        "property_amount": 100000.00,
        "total_tax": 441000.00,
        "trade_points_count": 4,
        "orders_count": 40,
        "employees_count": 18
    },
    "ИП Григорьев": {
        "inn": "7700000004",
        "kpp": "7700000014",
        "ogrn": "1234567890127",
        "revenue": 500000.00,
        "material_costs": 300000.00,
        "labor_costs": 100000.00,
        "operational_costs": 50000.00,
        "gross_profit": 50000.00,
        "vat_base": 500000.00,
        "vat_rate": 20.0,
        "vat_amount": 100000.00,
        "profit_tax_base": 50000.00,
        "profit_tax_rate": 20.0,
        "profit_tax_amount": 10000.00,
        "insurance_base": 100000.00,
        "pension_rate": 22.0,
        "pension_amount": 22000.00,
        "medical_rate": 5.1,
        "medical_amount": 5100.00,
        "social_rate": 2.9,
        "social_amount": 2900.00,
        "total_insurance": 30000.00,
        "property_base": 5000000.00,
        "property_rate": 2.0,
        "property_amount": 100000.00,
        "total_tax": 240000.00,
        "trade_points_count": 2,
        "orders_count": 20,
        "employees_count": 10
    },
    "ИП Козлова": {
        "inn": "7700000005",
        "kpp": "7700000015",
        "ogrn": "1234567890128",
        "revenue": 600000.00,
        "material_costs": 350000.00,
        "labor_costs": 120000.00,
        "operational_costs": 60000.00,
        "gross_profit": 70000.00,
        "vat_base": 600000.00,
        "vat_rate": 20.0,
        "vat_amount": 120000.00,
        "profit_tax_base": 70000.00,
        "profit_tax_rate": 20.0,
        "profit_tax_amount": 14000.00,
        "insurance_base": 120000.00,
        "pension_rate": 22.0,
        "pension_amount": 26400.00,
        "medical_rate": 5.1,
        "medical_amount": 6120.00,
        "social_rate": 2.9,
        "social_amount": 3480.00,
        "total_insurance": 36000.00,
        "property_base": 5000000.00,
        "property_rate": 2.0,
        "property_amount": 100000.00,
        "total_tax": 370000.00,
        "trade_points_count": 3,
        "orders_count": 25,
        "employees_count": 12
    },
    "ИП Сидоров": {
        "inn": "7700000006",
        "kpp": "7700000016",
        "ogrn": "1234567890129",
        "revenue": 700000.00,
        "material_costs": 400000.00,
        "labor_costs": 130000.00,
        "operational_costs": 70000.00,
        "gross_profit": 100000.00,
        "vat_base": 700000.00,
        "vat_rate": 20.0,
        "vat_amount": 140000.00,
        "profit_tax_base": 100000.00,
        "profit_tax_rate": 20.0,
        "profit_tax_amount": 20000.00,
        "insurance_base": 130000.00,
        "pension_rate": 22.0,
        "pension_amount": 28600.00,
        "medical_rate": 5.1,
        "medical_amount": 6630.00,
        "social_rate": 2.9,
        "social_amount": 3770.00,
        "total_insurance": 39000.00,
        "property_base": 5000000.00,
        "property_rate": 2.0,
        "property_amount": 100000.00,
        "total_tax": 399000.00,
        "trade_points_count": 4,
        "orders_count": 35,
        "employees_count": 14
    },
    "ООО 'ДрожжиПлюс'": {
        "inn": "7700000007",
        "kpp": "7700000017",
        "ogrn": "1234567890130",
        "revenue": 900000.00,
        "material_costs": 550000.00,
        "labor_costs": 180000.00,
        "operational_costs": 90000.00,
        "gross_profit": 80000.00,
        "vat_base": 900000.00,
        "vat_rate": 20.0,
        "vat_amount": 180000.00,
        "profit_tax_base": 80000.00,
        "profit_tax_rate": 20.0,
        "profit_tax_amount": 16000.00,
        "insurance_base": 180000.00,
        "pension_rate": 22.0,
        "pension_amount": 39600.00,
        "medical_rate": 5.1,
        "medical_amount": 9180.00,
        "social_rate": 2.9,
        "social_amount": 5220.00,
        "total_insurance": 54000.00,
        "property_base": 5000000.00,
        "property_rate": 2.0,
        "property_amount": 100000.00,
        "total_tax": 450000.00,
        "trade_points_count": 3,
        "orders_count": 28,
        "employees_count": 11
    },
    "ООО 'МолПродукт'": {
        "inn": "7700000008",
        "kpp": "7700000018",
        "ogrn": "1234567890131",
        "revenue": 1500000.00,
        "material_costs": 900000.00,
        "labor_costs": 300000.00,
        "operational_costs": 150000.00,
        "gross_profit": 150000.00,
        "vat_base": 1500000.00,
        "vat_rate": 20.0,
        "vat_amount": 300000.00,
        "profit_tax_base": 150000.00,
        "profit_tax_rate": 20.0,
        "profit_tax_amount": 30000.00,
        "insurance_base": 300000.00,
        "pension_rate": 22.0,
        "pension_amount": 66000.00,
        "medical_rate": 5.1,
        "medical_amount": 15300.00,
        "social_rate": 2.9,
        "social_amount": 8700.00,
        "total_insurance": 90000.00,
        "property_base": 5000000.00,
        "property_rate": 2.0,
        "property_amount": 100000.00,
        "total_tax": 520000.00,
        "trade_points_count": 6,
        "orders_count": 60,
        "employees_count": 25
    },
    "ООО 'МукаПром'": {
        "inn": "7700000009",
        "kpp": "7700000019",
        "ogrn": "1234567890132",
        "revenue": 1100000.00,
        "material_costs": 650000.00,
        "labor_costs": 220000.00,
        "operational_costs": 110000.00,
        "gross_profit": 120000.00,
        "vat_base": 1100000.00,
        "vat_rate": 20.0,
        "vat_amount": 220000.00,
        "profit_tax_base": 120000.00,
        "profit_tax_rate": 20.0,
        "profit_tax_amount": 24000.00,
        "insurance_base": 220000.00,
        "pension_rate": 22.0,
        "pension_amount": 48400.00,
        "medical_rate": 5.1,
        "medical_amount": 11220.00,
        "social_rate": 2.9,
        "social_amount": 6380.00,
        "total_insurance": 66000.00,
        "property_base": 5000000.00,
        "property_rate": 2.0,
        "property_amount": 100000.00,
        "total_tax": 410000.00,
        "trade_points_count": 4,
        "orders_count": 45,
        "employees_count": 15
    },
    "ООО 'УпаковкаТара'": {
        "inn": "7700000010",
        "kpp": "7700000020",
        "ogrn": "1234567890133",
        "revenue": 1300000.00,
        "material_costs": 800000.00,
        "labor_costs": 250000.00,
        "operational_costs": 130000.00,
        "gross_profit": 120000.00,
        "vat_base": 1300000.00,
        "vat_rate": 20.0,
        "vat_amount": 260000.00,
        "profit_tax_base": 120000.00,
        "profit_tax_rate": 20.0,
        "profit_tax_amount": 24000.00,
        "insurance_base": 250000.00,
        "pension_rate": 22.0,
        "pension_amount": 55000.00,
        "medical_rate": 5.1,
        "medical_amount": 12750.00,
        "social_rate": 2.9,
        "social_amount": 7250.00,
        "total_insurance": 75000.00,
        "property_base": 5000000.00,
        "property_rate": 2.0,
        "property_amount": 100000.00,
        "total_tax": 459000.00,
        "trade_points_count": 5,
        "orders_count": 55,
        "employees_count": 20
    },
    "ООО 'Хлебный Дом'": {
        "inn": "7701234567",
        "kpp": "770101001",
        "ogrn": "1027700132195",
        "revenue": 15000000.00,
        "material_costs": 4500000.00,
        "labor_costs": 3000000.00,
        "operational_costs": 2000000.00,
        "gross_profit": 5500000.00,
        "vat_base": 12500000.00,
        "vat_rate": 20,
        "vat_amount": 2500000.00,
        "profit_tax_base": 5500000.00,
        "profit_tax_rate": 20,
        "profit_tax_amount": 1100000.00,
        "insurance_base": 3000000.00,
        "pension_rate": 22,
        "pension_amount": 660000.00,
        "medical_rate": 5.1,
        "medical_amount": 153000.00,
        "social_rate": 2.9,
        "social_amount": 87000.00,
        "total_insurance": 900000.00,
        "property_base": 25000000.00,
        "property_rate": 2.2,
        "property_amount": 550000.00,
        "total_tax": 5100000.00,
        "trade_points_count": 5,
        "orders_count": 150,
        "employees_count": 25
    },
    "ИП Иванов И.И.": {
        "inn": "7709876543",
        "kpp": "770101002",
        "ogrn": "304770000012345",
        "revenue": 8000000.00,
        "material_costs": 2400000.00,
        "labor_costs": 1600000.00,
        "operational_costs": 1000000.00,
        "gross_profit": 3000000.00,
        "vat_base": 6666666.67,
        "vat_rate": 20,
        "vat_amount": 1333333.33,
        "profit_tax_base": 3000000.00,
        "profit_tax_rate": 20,
        "profit_tax_amount": 600000.00,
        "insurance_base": 1600000.00,
        "pension_rate": 22,
        "pension_amount": 352000.00,
        "medical_rate": 5.1,
        "medical_amount": 81600.00,
        "social_rate": 2.9,
        "social_amount": 46400.00,
        "total_insurance": 480000.00,
        "property_base": 12000000.00,
        "property_rate": 2.2,
        "property_amount": 264000.00,
        "total_tax": 2677733.33,
        "trade_points_count": 2,
        "orders_count": 80,
        "employees_count": 12
    },
    "ООО 'Свежая Выпечка'": {
        "inn": "7705555555",
        "kpp": "770101003",
        "ogrn": "1037700000123",
        "revenue": 12000000.00,
        "material_costs": 3600000.00,
        "labor_costs": 2400000.00,
        "operational_costs": 1600000.00,
        "gross_profit": 4400000.00,
        "vat_base": 10000000.00,
        "vat_rate": 20,
        "vat_amount": 2000000.00,
        "profit_tax_base": 4400000.00,
        "profit_tax_rate": 20,
        "profit_tax_amount": 880000.00,
        "insurance_base": 2400000.00,
        "pension_rate": 22,
        "pension_amount": 528000.00,
        "medical_rate": 5.1,
        "medical_amount": 122400.00,
        "social_rate": 2.9,
        "social_amount": 69600.00,
        "total_insurance": 720000.00,
        "property_base": 18000000.00,
        "property_rate": 2.2,
        "property_amount": 396000.00,
        "total_tax": 3996000.00,
        "trade_points_count": 3,
        "orders_count": 100,
        "employees_count": 18
    }
}

def get_company_names():
    """Возвращает список названий предприятий"""
    return list(REPORTS_DATA.keys())

def get_company_report(company_name):
    """Возвращает данные отчета для указанного предприятия"""
    return REPORTS_DATA.get(company_name)

def save_report_to_file(company_name, report_text, filename=None):
    """Сохраняет отчет в файл"""
    if filename is None:
        # Создаем имя файла на основе названия компании и текущей даты
        date_str = datetime.now().strftime("%Y%m%d")
        safe_company_name = company_name.replace(" ", "_").replace("'", "").replace('"', "")
        filename = f"отчет_{safe_company_name}_{date_str}.txt"
    
    # Создаем директорию reports, если она не существует
    os.makedirs("reports", exist_ok=True)
    
    # Полный путь к файлу
    filepath = os.path.join("reports", filename)
    
    # Сохраняем отчет в файл
    with open(filepath, "w", encoding="utf-8") as f:
        f.write(report_text)
    
    return filepath 